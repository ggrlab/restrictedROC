<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="restrictedROC">
<title>AUROC, Mann-Whitney U and Wilcoxon rank-sum â€¢ restrictedROC</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="AUROC, Mann-Whitney U and Wilcoxon rank-sum">
<meta property="og:description" content="restrictedROC">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">restrictedROC</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.3.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/examples_01_AUROC_TESTS.html">AUROC, Mann-Whitney U and Wilcoxon rank-sum</a>
    <a class="dropdown-item" href="../articles/paper_01_roccurves.html">Paper 01: ROC curves</a>
    <a class="dropdown-item" href="../articles/paper_02_rROC_theoretic.html">Paper 02: rROC theoretic</a>
    <a class="dropdown-item" href="../articles/paper_03_rROC_partROCs.html">Paper 03: rROC partROCs</a>
    <a class="dropdown-item" href="../articles/paper_04_rROC_theoretic_FPR.html">Paper 04: rROC theoretic with FPR</a>
    <a class="dropdown-item" href="../articles/paper_05_varying_mean_variance.html">Paper 05: rROC with varying mean/variance</a>
    <a class="dropdown-item" href="../articles/paper_06_rROC_scaling_vs_recalculate.html">Paper 06: rROC scaling/recalculating</a>
    <a class="dropdown-item" href="../articles/paper_07_rROC_twoway.html">Paper 07: rROC label swap</a>
    <a class="dropdown-item" href="../articles/paper_08_rROC_permutation_bias.html">Paper 08: rROC permutation</a>
    <a class="dropdown-item" href="../articles/paper_09_cartoon_fig2.html">Paper 09: rROC concept</a>
    <a class="dropdown-item" href="../articles/vignette_01_rzAUC_colors.html">Vignette 01: rzAUC colors</a>
    <a class="dropdown-item" href="../articles/vignette_02_restriction_plots.html">Vignette 02: Restriction plots</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>AUROC, Mann-Whitney U and Wilcoxon rank-sum</h1>
            
      
      
      <div class="d-none name"><code>examples_01_AUROC_TESTS.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>warn <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggrlab.github.io/restrictedROC/">restrictedROC</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span> <span class="co"># for rnbinom</span></span>
<span><span class="va">main_plotname</span> <span class="op">&lt;-</span> <span class="st">"res/paper/auroc_wilcoxon"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="st">"res/paper"</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>From <cite><a href="Wackerly,%20Dennis,%20William%20Mendenhall,%20and%20Richard%20L.%20Scheaffer.%20Mathematical%20statistics%20with%20applications.%20Cengage%20Learning,%202014.">Wackerly
et al, 2014, Cengage Learning</a></cite>: The Mann-Whitney U test is a
nonparametric test obtained by:</p>
<ol style="list-style-type: decimal">
<li>Ordering all (n_1 + n_2) observations by their value</li>
<li>Count how many observations of sample I precede <em>each</em>
observation of sample II</li>
<li>Sum all counts from step 2</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example from Wackerly 2014, p758, 15.6</span></span>
<span><span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">26</span>, <span class="fl">27</span>, <span class="fl">28</span>, <span class="fl">29</span>, <span class="fl">31</span>, <span class="fl">32</span>, <span class="fl">35</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"I"</span>, <span class="st">"I"</span>, <span class="st">"I"</span>, <span class="st">"II"</span>, <span class="st">"II"</span>, <span class="st">"I"</span>, <span class="st">"II"</span>, <span class="st">"II"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span></span>
<span><span class="co">#&gt;  I  I  I II II  I II II </span></span>
<span><span class="co">#&gt; 25 26 27 28 29 31 32 35</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Count how many observations in I and II</span></span>
<span><span class="va">n_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">values</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span> <span class="op">==</span> <span class="st">"I"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">n_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">values</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span> <span class="op">==</span> <span class="st">"II"</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Ordering all (n_1 + n_2) observations by their value</span></span>
<span><span class="va">values_sorted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">values_sorted</span><span class="op">)</span></span>
<span><span class="co">#&gt;  I  I  I II II  I II II </span></span>
<span><span class="co">#&gt; 25 26 27 28 29 31 32 35</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># 2. Count how many observations of sample I precede each observation of sample II</span></span>
<span><span class="va">u_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">y_observation</span> <span class="kw">in</span> <span class="va">values_sorted</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">values_sorted</span><span class="op">)</span> <span class="op">==</span> <span class="st">"II"</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">u_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">u_values</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">values_sorted</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">values_sorted</span><span class="op">)</span> <span class="op">==</span> <span class="st">"I"</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">y_observation</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">u_total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">u_values</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">u_total</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 14</span></span></code></pre></div>
<p>From <cite><a href="Wackerly,%20Dennis,%20William%20Mendenhall,%20and%20Richard%20L.%20Scheaffer.%20Mathematical%20statistics%20with%20applications.%20Cengage%20Learning,%202014.">Wackerly
et al, 2014, Cengage Learning</a>, 15.6</cite> we see that the U
statistic has a direct connection to the Wilcoxon rank sum statistic.
For that, we need to calculate the ranks of the values.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">values_ranks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html" class="external-link">rank</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">values_ranks</span><span class="op">)</span></span>
<span><span class="co">#&gt;  I  I  I II II  I II II </span></span>
<span><span class="co">#&gt;  1  2  3  4  5  6  7  8</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Sum of ranks of for sample I and II</span></span>
<span><span class="va">rs_I</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">values_ranks</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">values_ranks</span><span class="op">)</span> <span class="op">==</span> <span class="st">"I"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">rs_II</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">values_ranks</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">values_ranks</span><span class="op">)</span> <span class="op">==</span> <span class="st">"II"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">ranksum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">rs_I</span>, <span class="va">rs_II</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ranksum</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 12</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># R's wilcox.test:</span></span>
<span><span class="co">#   STATISTIC &lt;- c(W = sum(r[seq_along(x)]) - n.x * (n.x + 1)/2)</span></span>
<span><span class="co"># translated:</span></span>
<span><span class="co">#  STATISTIC &lt;- c("W"=rs_I - n_1*(n_1 + 1)/2)</span></span>
<span><span class="va">w_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">values</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span> <span class="op">==</span> <span class="st">"I"</span><span class="op">]</span>,</span>
<span>    y <span class="op">=</span> <span class="va">values</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span> <span class="op">==</span> <span class="st">"II"</span><span class="op">]</span>,</span>
<span>    paired <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    alternative <span class="op">=</span> <span class="st">"two.sided"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">w_test</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Wilcoxon rank sum exact test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  values[names(values) == "I"] and values[names(values) == "II"]</span></span>
<span><span class="co">#&gt; W = 2, p-value = 0.1143</span></span>
<span><span class="co">#&gt; alternative hypothesis: true location shift is not equal to 0</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"W - manually calculated"</span> <span class="op">=</span> <span class="va">rs_I</span> <span class="op">-</span> <span class="va">n_1</span> <span class="op">*</span> <span class="op">(</span><span class="va">n_1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; W - manually calculated </span></span>
<span><span class="co">#&gt;                       2</span></span></code></pre></div>
<p>With the formula from Wackerly2014:</p>
<p><span class="math display">\[
U = n_1 n_2 + \frac{n_1 (n_1 + 1)}{2} - ranksum_{I}
\]</span></p>
<p>we see that <span class="math display">\[
ranksum_{I} = n_1 n_2 + \frac{n_1 (n_1 + 1)}{2} - U
\]</span></p>
<p>and therefore</p>
<p><span class="math display">\[
W_{Rwilcox} = ranksum_{I} - \frac{n_1 (n_1 + 1)}{2} = n_1 n_2 - U
\]</span></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ranksum_I_from_u</span> <span class="op">&lt;-</span> <span class="va">n_1</span> <span class="op">*</span> <span class="va">n_2</span> <span class="op">+</span> <span class="va">n_1</span> <span class="op">*</span> <span class="op">(</span><span class="va">n_1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span> <span class="op">-</span> <span class="va">u_total</span></span>
<span><span class="va">w_r</span> <span class="op">&lt;-</span> <span class="va">ranksum_I_from_u</span> <span class="op">-</span> <span class="va">n_1</span> <span class="op">*</span> <span class="op">(</span><span class="va">n_1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span><span class="va">w_r_alternative</span> <span class="op">&lt;-</span> <span class="va">n_1</span> <span class="op">*</span> <span class="va">n_2</span> <span class="op">-</span> <span class="va">u_total</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">w_r_alternative</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">w_r</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">w_test</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Wilcoxon rank sum exact test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  values[names(values) == "I"] and values[names(values) == "II"]</span></span>
<span><span class="co">#&gt; W = 2, p-value = 0.1143</span></span>
<span><span class="co">#&gt; alternative hypothesis: true location shift is not equal to 0</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">u_from_wilcox</span> <span class="op">&lt;-</span> <span class="va">n_1</span> <span class="op">*</span> <span class="va">n_2</span> <span class="op">-</span> <span class="va">w_test</span><span class="op">$</span><span class="va">statistic</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">u_from_wilcox</span><span class="op">)</span></span>
<span><span class="co">#&gt;  W </span></span>
<span><span class="co">#&gt; 14</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">u_total</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 14</span></span></code></pre></div>
<div class="section level3">
<h3 id="auroc-is-the-equivalent-to-mann-whitney-u-statistic">AUROC is the equivalent to Mann-Whitney U statistic<a class="anchor" aria-label="anchor" href="#auroc-is-the-equivalent-to-mann-whitney-u-statistic"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example from Wackerly 2014, p758, 15.6</span></span>
<span><span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">26</span>, <span class="fl">27</span>, <span class="fl">28</span>, <span class="fl">29</span>, <span class="fl">31</span>, <span class="fl">32</span>, <span class="fl">35</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"I"</span>, <span class="st">"I"</span>, <span class="st">"I"</span>, <span class="st">"II"</span>, <span class="st">"II"</span>, <span class="st">"I"</span>, <span class="st">"II"</span>, <span class="st">"II"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span></span>
<span><span class="co">#&gt;  I  I  I II II  I II II </span></span>
<span><span class="co">#&gt; 25 26 27 28 29 31 32 35</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Count how many observations in I and II</span></span>
<span><span class="va">n_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">values</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span> <span class="op">==</span> <span class="st">"I"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">n_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">values</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span> <span class="op">==</span> <span class="st">"II"</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">auroc_from_u</span> <span class="op">&lt;-</span> <span class="va">u_total</span> <span class="op">/</span> <span class="op">(</span><span class="va">n_1</span> <span class="op">*</span> <span class="va">n_2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">auroc_from_u</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.875</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Explicitely calculate AUC with pROC</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html" class="external-link">roc</a></span><span class="op">(</span></span>
<span>    response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span>,</span>
<span>    predictor <span class="op">=</span> <span class="va">values</span>,</span>
<span>    levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"I"</span>, <span class="st">"II"</span><span class="op">)</span>,</span>
<span>    direction <span class="op">=</span> <span class="st">"&lt;"</span>,</span>
<span>    auc <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; roc.default(response = names(values), predictor = values, levels = c("I",     "II"), direction = "&lt;", auc = TRUE)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Data: values in 4 controls (names(values) I) &lt; 4 cases (names(values) II).</span></span>
<span><span class="co">#&gt; Area under the curve: 0.875</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="bigger-example-of-auroc-vs-mann-whitney-u-statistic">Bigger example of AUROC vs Mann-Whitney U statistic<a class="anchor" aria-label="anchor" href="#bigger-example-of-auroc-vs-mann-whitney-u-statistic"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">50</span>, mean <span class="op">=</span> <span class="fl">8</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">50</span>, mean <span class="op">=</span> <span class="fl">9</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"[0-9]*"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">n_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">values</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span> <span class="op">==</span> <span class="st">"a"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">n_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">values</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span> <span class="op">==</span> <span class="st">"b"</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">big_roc</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html" class="external-link">roc</a></span><span class="op">(</span></span>
<span>    response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span>,</span>
<span>    predictor <span class="op">=</span> <span class="va">values</span>,</span>
<span>    levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>,</span>
<span>    direction <span class="op">=</span> <span class="st">"&lt;"</span>,</span>
<span>    auc <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">big_wilcox</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">values</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span> <span class="op">==</span> <span class="st">"a"</span><span class="op">]</span>,</span>
<span>    y <span class="op">=</span> <span class="va">values</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span> <span class="op">==</span> <span class="st">"b"</span><span class="op">]</span>,</span>
<span>    paired <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    alternative <span class="op">=</span> <span class="st">"two.sided"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">big_ttest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">values</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span> <span class="op">==</span> <span class="st">"a"</span><span class="op">]</span>,</span>
<span>    y <span class="op">=</span> <span class="va">values</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span> <span class="op">==</span> <span class="st">"b"</span><span class="op">]</span>,</span>
<span>    paired <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    alternative <span class="op">=</span> <span class="st">"two.sided"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">u_from_wilcox</span> <span class="op">&lt;-</span> <span class="va">n_1</span> <span class="op">*</span> <span class="va">n_2</span> <span class="op">-</span> <span class="va">big_wilcox</span><span class="op">$</span><span class="va">statistic</span></span>
<span><span class="va">auc_from_u</span> <span class="op">&lt;-</span> <span class="va">u_from_wilcox</span> <span class="op">/</span> <span class="op">(</span><span class="va">n_1</span> <span class="op">*</span> <span class="va">n_2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">auc_from_u</span><span class="op">)</span></span>
<span><span class="co">#&gt;      W </span></span>
<span><span class="co">#&gt; 0.5592</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">big_roc</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; roc.default(response = names(values), predictor = values, levels = c("a",     "b"), direction = "&lt;", auc = TRUE)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Data: values in 50 controls (names(values) a) &lt; 50 cases (names(values) b).</span></span>
<span><span class="co">#&gt; Area under the curve: 0.5592</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Plot ROC curve</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">df_split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">values</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_box</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">df_split</span>, <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">name</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">name</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span>, width <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span> <span class="op">=</span> <span class="st">"#ee000070"</span>, <span class="st">"b"</span> <span class="op">=</span> <span class="st">"#008B4570"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/theme_pubr.html" class="external-link">theme_pubr</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">plots_rroc</span> <span class="op">&lt;-</span> <span class="fu">restrictedROC</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_density_ROC_empirical.html">plot_density_ROC_empirical</a></span><span class="op">(</span></span>
<span>    values_grouped <span class="op">=</span> <span class="va">df_split</span>,</span>
<span>    xmin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span>, xmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span>,</span>
<span>    levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>,</span>
<span>    direction <span class="op">=</span> <span class="st">"&lt;"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">scaling</span> <span class="op">&lt;-</span> <span class="fl">.35</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html" class="external-link">pdf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">main_plotname</span>, <span class="st">"boxplot_density_roc.pdf"</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">30</span> <span class="op">*</span> <span class="va">scaling</span>, height <span class="op">=</span> <span class="fl">10</span> <span class="op">*</span> <span class="va">scaling</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">51</span><span class="op">)</span> <span class="co"># for geom_jitter reproducibility</span></span>
<span><span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span></span>
<span>    <span class="va">plot_box</span>,</span>
<span>    <span class="va">plots_rroc</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span> <span class="op">=</span> <span class="st">"#ee000070"</span>, <span class="st">"b"</span> <span class="op">=</span> <span class="st">"#008B4570"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="va">plots_rroc</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Scale for <span style="color: #00BB00;">fill</span> is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for <span style="color: #00BB00;">fill</span>, which will replace the existing scale.</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; agg_png </span></span>
<span><span class="co">#&gt;       2</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rroc_perm</span> <span class="op">&lt;-</span> <span class="fu">restrictedROC</span><span class="fu">::</span><span class="fu"><a href="../reference/simple_rROC_permutation.html">simple_rROC_permutation</a></span><span class="op">(</span></span>
<span>    response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span>,</span>
<span>    predictor <span class="op">=</span> <span class="va">values</span>,</span>
<span>    n_permutations <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    positive_label <span class="op">=</span> <span class="st">"b"</span>,</span>
<span>    direction <span class="op">=</span> <span class="st">"&lt;"</span>,</span>
<span>    return_proc <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># nolint start</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">big_roc</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; roc.default(response = names(values), predictor = values, levels = c("a",     "b"), direction = "&lt;", auc = TRUE)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Data: values in 50 controls (names(values) a) &lt; 50 cases (names(values) b).</span></span>
<span><span class="co">#&gt; Area under the curve: 0.5592</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Call:</span></span>
<span><span class="co"># roc.default(response = names(values), predictor = values, levels = c("a",     "b"), direction = "&lt;", auc = TRUE)</span></span>
<span></span>
<span><span class="co"># Data: values in 50 controls (names(values) a) &lt; 50 cases (names(values) b).</span></span>
<span><span class="co"># Area under the curve: 0.5592</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">big_ttest</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Welch Two Sample t-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  values[names(values) == "a"] and values[names(values) == "b"]</span></span>
<span><span class="co">#&gt; t = -1.7942, df = 69.92, p-value = 0.07711</span></span>
<span><span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  -1.41436615  0.07477889</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; mean of x mean of y </span></span>
<span><span class="co">#&gt;  8.069138  8.738932</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#         Welch Two Sample t-test</span></span>
<span><span class="co"># data:  values[names(values) == "a"] and values[names(values) == "b"]</span></span>
<span><span class="co"># t = -1.7942, df = 69.92, p-value = 0.07711</span></span>
<span><span class="co"># alternative hypothesis: true difference in means is not equal to 0</span></span>
<span><span class="co"># 95 percent confidence interval:</span></span>
<span><span class="co">#  -1.41436615  0.07477889</span></span>
<span><span class="co"># sample estimates:</span></span>
<span><span class="co"># mean of x mean of y</span></span>
<span><span class="co">#  8.069138  8.738932</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">big_wilcox</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Wilcoxon rank sum test with continuity correction</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  values[names(values) == "a"] and values[names(values) == "b"]</span></span>
<span><span class="co">#&gt; W = 1102, p-value = 0.3092</span></span>
<span><span class="co">#&gt; alternative hypothesis: true location shift is not equal to 0</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># data:  values[names(values) == "a"] and values[names(values) == "b"]</span></span>
<span><span class="co"># W = 1102, p-value = 0.3092</span></span>
<span><span class="co"># alternative hypothesis: true location shift is not equal to 0</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">rroc_perm</span><span class="op">$</span><span class="va">permutation_pval</span><span class="op">)</span></span>
<span><span class="co">#&gt;    pval.twoside.max pval.twoside.global      n_permutations </span></span>
<span><span class="co">#&gt;        6.993007e-03        3.226773e-01        1.000000e+03</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#    pval.twoside.max pval.twoside.global      n_permutations</span></span>
<span><span class="co">#        6.993007e-03        3.226773e-01        1.000000e+03</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">rroc_perm</span><span class="op">$</span><span class="va">max_total</span><span class="op">)</span></span>
<span><span class="co">#&gt;         auc auc_var_H0    rzAUC    pval_asym threshold part</span></span>
<span><span class="co">#&gt; 1 0.7549342 0.00486568 3.654739 0.0002574438  7.381726 high</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#         auc auc_var_H0    rzAUC    pval_asym threshold part</span></span>
<span><span class="co"># 1 0.7549342 0.00486568 3.654739 0.0002574438  7.381726 high</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Informative range established from restriction: ("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">rroc_perm</span><span class="op">$</span><span class="va">max_total</span><span class="op">[[</span><span class="st">"threshold"</span><span class="op">]</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">", Inf)\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="co">#&gt; Informative range established from restriction: (7.38, Inf)</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Informative range established from restriction: (7.38, Inf)</span></span>
<span><span class="co"># nolint end</span></span>
<span></span>
<span><span class="va">rroc_part_plots</span> <span class="op">&lt;-</span> <span class="fu">restrictedROC</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_rROC_part.html">plot_rROC_part</a></span><span class="op">(</span></span>
<span>    <span class="va">rroc_perm</span>,</span>
<span>    threshold <span class="op">=</span> <span class="va">rroc_perm</span><span class="op">$</span><span class="va">max_total</span><span class="op">[[</span><span class="st">"threshold"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span><span class="va">informative_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rroc_perm</span><span class="op">$</span><span class="va">max_total</span><span class="op">[[</span><span class="st">"threshold"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html" class="external-link">pdf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">main_plotname</span>, <span class="st">"boxplot_density_roc_restriction.pdf"</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">30</span> <span class="op">*</span> <span class="va">scaling</span>, height <span class="op">=</span> <span class="fl">10</span> <span class="op">*</span> <span class="va">scaling</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">51</span><span class="op">)</span> <span class="co"># for geom_jitter reproducibility</span></span>
<span><span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span></span>
<span>    <span class="va">plot_box</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">informative_range</span>, col <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="va">plots_rroc</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">informative_range</span>, col <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span> <span class="op">=</span> <span class="st">"#ee000070"</span>, <span class="st">"b"</span> <span class="op">=</span> <span class="st">"#008B4570"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="va">plots_rroc</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Scale for <span style="color: #00BB00;">fill</span> is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for <span style="color: #00BB00;">fill</span>, which will replace the existing scale.</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; agg_png </span></span>
<span><span class="co">#&gt;       2</span></span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html" class="external-link">pdf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">main_plotname</span>, <span class="st">"boxplot_density_roc_restriction_parts.pdf"</span><span class="op">)</span>, height <span class="op">=</span> <span class="fl">4</span>, width <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">rroc_part_plots</span><span class="op">)</span></span>
<span><span class="co">#&gt; $plotlist</span></span>
<span><span class="co">#&gt; $plotlist$A</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $plotlist$B</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $plotlist$C</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $plotlist$D</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $plotlist$E</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $plotlist$F</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $patchworked</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; agg_png </span></span>
<span><span class="co">#&gt;       2</span></span></code></pre></div>
<p>Râ€™s two-sample <code>wilcoxon.test</code> is (by default) calculated
â€œexactâ€ if there are less than 50 observations in both groups.
<code>n.x</code> is the number of samples in the first group,
<code>n.y</code> the number of samples in the second group.</p>
<p>See <a href="https://github.com/SurajGupta/r-source/blob/master/src/library/stats/R/wilcox.test.R" class="external-link uri">https://github.com/SurajGupta/r-source/blob/master/src/library/stats/R/wilcox.test.R</a>
for the code. Briefly going through that code:</p>
<ul>
<li>Line 245 starts the two sample case</li>
<li>Line 252: If <code>exact == NULL</code> (default), then
<code>exact &lt;- (n.x &lt; 50) &amp;&amp; (n.y &lt; 50)</code>
</li>
<li>With ties: z-standardization approximization</li>
<li>Without ties: Exact calculation</li>
</ul>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html" class="external-link">rank</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">mu</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">STATISTIC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"W"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">r</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="va">n.x</span> <span class="op">*</span> <span class="op">(</span><span class="va">n.x</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">NTIES</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="va">STATISTIC</span> <span class="op">-</span> <span class="va">n.x</span> <span class="op">*</span> <span class="va">n.y</span> <span class="op">/</span> <span class="fl">2</span></span>
<span><span class="va">SIGMA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">n.x</span> <span class="op">*</span> <span class="va">n.y</span> <span class="op">/</span> <span class="fl">12</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="va">n.x</span> <span class="op">+</span> <span class="va">n.y</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">NTIES</span><span class="op">^</span><span class="fl">3</span> <span class="op">-</span> <span class="va">NTIES</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="op">(</span><span class="va">n.x</span> <span class="op">+</span> <span class="va">n.y</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">n.x</span> <span class="op">+</span> <span class="va">n.y</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">z</span> <span class="op">-</span> <span class="va">CORRECTION</span><span class="op">)</span> <span class="op">/</span> <span class="va">SIGMA</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">correct</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">CORRECTION</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">alternative</span>,</span>
<span>        <span class="st">"two.sided"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.5</span>,</span>
<span>        <span class="st">"greater"</span> <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>        <span class="st">"less"</span> <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">METHOD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">METHOD</span>, <span class="st">"with continuity correction"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">PVAL</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">alternative</span>,</span>
<span>    <span class="st">"less"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>,</span>
<span>    <span class="st">"greater"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="va">z</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>    <span class="st">"two.sided"</span> <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="va">z</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html" class="external-link">rank</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">mu</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">STATISTIC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"W"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">r</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="va">n.x</span> <span class="op">*</span> <span class="op">(</span><span class="va">n.x</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PVAL</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">alternative</span>,</span>
<span>    <span class="st">"two.sided"</span> <span class="op">=</span> <span class="op">{</span></span>
<span>        <span class="va">p</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="va">STATISTIC</span> <span class="op">&gt;</span> <span class="op">(</span><span class="va">n.x</span> <span class="op">*</span> <span class="va">n.y</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/stats/Wilcoxon.html" class="external-link">pwilcox</a></span><span class="op">(</span><span class="va">STATISTIC</span> <span class="op">-</span> <span class="fl">1</span>, <span class="va">n.x</span>, <span class="va">n.y</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/stats/Wilcoxon.html" class="external-link">pwilcox</a></span><span class="op">(</span><span class="va">STATISTIC</span>, <span class="va">n.x</span>, <span class="va">n.y</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">p</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    <span class="st">"greater"</span> <span class="op">=</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/Wilcoxon.html" class="external-link">pwilcox</a></span><span class="op">(</span><span class="va">STATISTIC</span> <span class="op">-</span> <span class="fl">1</span>, <span class="va">n.x</span>, <span class="va">n.y</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    <span class="st">"less"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Wilcoxon.html" class="external-link">pwilcox</a></span><span class="op">(</span><span class="va">STATISTIC</span>, <span class="va">n.x</span>, <span class="va">n.y</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">55</span>, mean <span class="op">=</span> <span class="fl">8</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">55</span>, mean <span class="op">=</span> <span class="fl">8</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="co"># b = rnorm(75, mean = 8, sd = 2)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"[0-9]*"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rroc_perm_2</span> <span class="op">&lt;-</span> <span class="fu">restrictedROC</span><span class="fu">::</span><span class="fu"><a href="../reference/rROC.html">rROC</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="va">values</span>,</span>
<span>    n_permutations <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    positive_label <span class="op">=</span> <span class="st">"b"</span>,</span>
<span>    direction <span class="op">=</span> <span class="st">"&lt;"</span>,</span>
<span>    return_proc <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Thu Jun 13 06:33:11 2024      y x ( 1 )</span></span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rroc_perfs</span> <span class="op">&lt;-</span> <span class="va">rroc_perm_2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"permutation"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"performances"</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="va">data_df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span>,</span>
<span>    predictor <span class="op">=</span> <span class="va">values</span></span>
<span><span class="op">)</span></span>
<span><span class="va">wilcox_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">rroc_perfs</span><span class="op">[[</span><span class="st">"threshold"</span><span class="op">]</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">t_x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">samples_above_threshold</span> <span class="op">&lt;-</span> <span class="va">data_df</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">predictor</span> <span class="op">&gt;</span> <span class="va">t_x</span><span class="op">)</span></span>
<span>    <span class="va">samples_a</span> <span class="op">&lt;-</span> <span class="va">samples_above_threshold</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">response</span> <span class="op">==</span> <span class="st">"a"</span><span class="op">)</span></span>
<span>    <span class="va">samples_b</span> <span class="op">&lt;-</span> <span class="va">samples_above_threshold</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">response</span> <span class="op">==</span> <span class="st">"b"</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">samples_b</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">samples_a</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="va">samples_a</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">predictor</span><span class="op">)</span>,</span>
<span>        y <span class="op">=</span> <span class="va">samples_b</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">predictor</span><span class="op">)</span>,</span>
<span>        alternative <span class="op">=</span> <span class="st">"two.sided"</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">w_statistic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">wilcox_res</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">statistic</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">w_pvalue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">wilcox_res</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rroc_perfs</span><span class="op">[[</span><span class="st">"w.statistic"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">rroc_perfs</span><span class="op">[[</span><span class="st">"w.pvalue"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">rroc_perfs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">w_statistic</span><span class="op">)</span>, <span class="st">"w.statistic"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">w_statistic</span></span>
<span><span class="va">rroc_perfs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">w_pvalue</span><span class="op">)</span>, <span class="st">"w.pvalue"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">w_pvalue</span></span>
<span></span>
<span><span class="va">rroc_perfs</span><span class="op">[[</span><span class="st">"u_from_wilcox"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">rroc_perfs</span>, <span class="va">positives_high</span> <span class="op">*</span> <span class="va">negatives_high</span> <span class="op">-</span> <span class="va">w.statistic</span><span class="op">)</span></span>
<span><span class="va">rroc_perfs</span><span class="op">[[</span><span class="st">"auroc_from_u"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">rroc_perfs</span>, <span class="va">u_from_wilcox</span> <span class="op">/</span> <span class="op">(</span><span class="va">positives_high</span> <span class="op">*</span> <span class="va">negatives_high</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rroc_perfs</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, <span class="fl">20</span><span class="op">:</span><span class="fl">25</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 111 Ã— 14</span></span></span>
<span><span class="co">#&gt;    threshold auc_high positives_high negatives_high scaling_high auc_var_H0_high</span></span>
<span><span class="co">#&gt;        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>   -<span style="color: #BB0000;">Inf</span>       0.391             55             55         1            0.003<span style="text-decoration: underline;">06</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>      6.24    0.379             55             54         1.02         0.003<span style="text-decoration: underline;">09</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>      6.27    0.386             54             54         1.04         0.003<span style="text-decoration: underline;">11</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>      6.29    0.394             53             54         1.06         0.003<span style="text-decoration: underline;">14</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>      6.41    0.382             53             53         1.08         0.003<span style="text-decoration: underline;">17</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>      6.52    0.370             53             52         1.10         0.003<span style="text-decoration: underline;">21</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>      6.61    0.378             52             52         1.12         0.003<span style="text-decoration: underline;">24</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>      6.69    0.385             51             52         1.14         0.003<span style="text-decoration: underline;">27</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>      6.71    0.393             50             52         1.16         0.003<span style="text-decoration: underline;">30</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>      6.72    0.381             50             51         1.19         0.003<span style="text-decoration: underline;">33</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 101 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 8 more variables: rzAUC_high &lt;dbl&gt;, pval_asym_onesided_high &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   tpr_global &lt;dbl&gt;, fpr_global &lt;dbl&gt;, w.statistic &lt;dbl&gt;, w.pvalue &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   u_from_wilcox &lt;dbl&gt;, auroc_from_u &lt;dbl&gt;</span></span></span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">rroc_perfs</span><span class="op">[[</span><span class="st">"fpr_global"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;   [1] 1.00000000 0.98181818 0.98181818 0.98181818 0.96363636 0.94545455</span></span>
<span><span class="co">#&gt;   [7] 0.94545455 0.94545455 0.94545455 0.92727273 0.92727273 0.92727273</span></span>
<span><span class="co">#&gt;  [13] 0.92727273 0.92727273 0.92727273 0.92727273 0.90909091 0.89090909</span></span>
<span><span class="co">#&gt;  [19] 0.89090909 0.87272727 0.87272727 0.87272727 0.85454545 0.85454545</span></span>
<span><span class="co">#&gt;  [25] 0.83636364 0.81818182 0.80000000 0.80000000 0.80000000 0.80000000</span></span>
<span><span class="co">#&gt;  [31] 0.80000000 0.78181818 0.78181818 0.76363636 0.74545455 0.74545455</span></span>
<span><span class="co">#&gt;  [37] 0.72727273 0.72727273 0.72727273 0.70909091 0.69090909 0.69090909</span></span>
<span><span class="co">#&gt;  [43] 0.69090909 0.67272727 0.67272727 0.65454545 0.65454545 0.65454545</span></span>
<span><span class="co">#&gt;  [49] 0.65454545 0.65454545 0.65454545 0.63636364 0.61818182 0.61818182</span></span>
<span><span class="co">#&gt;  [55] 0.61818182 0.60000000 0.58181818 0.56363636 0.54545455 0.54545455</span></span>
<span><span class="co">#&gt;  [61] 0.52727273 0.52727273 0.50909091 0.50909091 0.50909091 0.49090909</span></span>
<span><span class="co">#&gt;  [67] 0.47272727 0.47272727 0.45454545 0.43636364 0.43636364 0.43636364</span></span>
<span><span class="co">#&gt;  [73] 0.41818182 0.40000000 0.40000000 0.38181818 0.36363636 0.34545455</span></span>
<span><span class="co">#&gt;  [79] 0.34545455 0.34545455 0.34545455 0.32727273 0.32727273 0.32727273</span></span>
<span><span class="co">#&gt;  [85] 0.30909091 0.30909091 0.29090909 0.29090909 0.27272727 0.25454545</span></span>
<span><span class="co">#&gt;  [91] 0.23636364 0.23636364 0.21818182 0.21818182 0.20000000 0.18181818</span></span>
<span><span class="co">#&gt;  [97] 0.16363636 0.16363636 0.14545455 0.12727273 0.10909091 0.09090909</span></span>
<span><span class="co">#&gt; [103] 0.09090909 0.07272727 0.07272727 0.05454545 0.03636364 0.01818182</span></span>
<span><span class="co">#&gt; [109] 0.00000000 0.00000000 0.00000000</span></span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rroc_perfs</span><span class="op">[[</span><span class="st">"w.pvalue"</span><span class="op">]</span><span class="op">]</span> <span class="op">-</span> <span class="va">rroc_perfs</span><span class="op">[[</span><span class="st">"pval_asym_high"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;   [1] 0.0003396897 0.0002304702 0.0003108431 0.0004146124 0.0002857465</span></span>
<span><span class="co">#&gt;   [6] 0.0001872807 0.0002569748 0.0003489478 0.0004683155 0.0003225519</span></span>
<span><span class="co">#&gt;  [11] 0.0004366585 0.0005835785 0.0007687320 0.0009963163 0.0012679749</span></span>
<span><span class="co">#&gt;  [16] 0.0015811224 0.0012833854 0.0014884505 0.0021854832 0.0014326423</span></span>
<span><span class="co">#&gt;  [21] 0.0021450978 0.0029315980 0.0021343097 0.0029511254 0.0021202277</span></span>
<span><span class="co">#&gt;  [26] 0.0012993356 0.0005918934 0.0011862297 0.0019520296 0.0028552880</span></span>
<span><span class="co">#&gt;  [31] 0.0038150164 0.0029027484 0.0039089297 0.0029524494 0.0019362525</span></span>
<span><span class="co">#&gt;  [36] 0.0029474325 0.0018911422 0.0029366558 0.0041033968 0.0029853726</span></span>
<span><span class="co">#&gt;  [41] 0.0018409164 0.0029654999 0.0042560044 0.0030141898 0.0043742524</span></span>
<span><span class="co">#&gt;  [46] 0.0030657910 0.0045011260 0.0059579880 0.0071326302 0.0076656332</span></span>
<span><span class="co">#&gt;  [51] 0.0072757507 0.0079660796 0.0080909831 0.0082478910 0.0072922626</span></span>
<span><span class="co">#&gt;  [56] 0.0084199745 0.0090313282 0.0089158073 0.0079886342 0.0095051961</span></span>
<span><span class="co">#&gt;  [61] 0.0086361252 0.0101483188 0.0093723530 0.0108431742 0.0108327744</span></span>
<span><span class="co">#&gt;  [66] 0.0115895438 0.0112752483 0.0123214773 0.0123129744 0.0109797200</span></span>
<span><span class="co">#&gt;  [71] 0.0133505485 0.0137890254 0.0145621721 0.0137669517 0.0157755667</span></span>
<span><span class="co">#&gt;  [76] 0.0153711960 0.0130347841 0.0091403003 0.0141600292 0.0186343847</span></span>
<span><span class="co">#&gt;  [81] 0.0200944018 0.0211010021 0.0212084593 0.0234064201 0.0214991123</span></span>
<span><span class="co">#&gt;  [86] 0.0274921390 0.0279998626 0.0276812676 0.0318385358 0.0343985838</span></span>
<span><span class="co">#&gt;  [91] 0.0343350001 0.0371438028 0.0423128966 0.0284212883 0.0377763522</span></span>
<span><span class="co">#&gt;  [96] 0.0482931603 0.0578873709 0.0336865760 0.0483456757 0.0674169901</span></span>
<span><span class="co">#&gt; [101] 0.0870925246 0.0982659643 0.0961396165 0.1490713064 0.0692558269</span></span>
<span><span class="co">#&gt; [106] 0.1167354833 0.2119980830 0.4459953047           NA           NA</span></span>
<span><span class="co">#&gt; [111]           NA</span></span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html" class="external-link">pdf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">main_plotname</span>, <span class="st">"rzAUC_vs_wilcox.pdf"</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">6</span>, height <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rroc_perfs</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">auc_high</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">auroc_from_u</span> <span class="op">-</span> <span class="va">auc_high</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span></span>
<span>            <span class="st">"Restricted rAUC == (rAUC from wilcoxon test)?"</span>,</span>
<span>            subtitle <span class="op">=</span> <span class="st">"Sanity check if restricted AUC is equivalent to calculated AUC \nfrom multiple wilcoxon test on the corresponding sample subsets"</span></span>
<span>        <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/theme_pubr.html" class="external-link">theme_pubr</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>            plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>            plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 3 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>        <span class="va">rroc_perfs</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">fpr_global</span>, <span class="va">pval_asym_high</span>, <span class="va">w.pvalue</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">fpr_global</span>, names_to <span class="op">=</span> <span class="st">"name"</span>, values_to <span class="op">=</span> <span class="st">"p.value"</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fpr_global</span>, y <span class="op">=</span> <span class="op">(</span><span class="va">p.value</span><span class="op">)</span>, col <span class="op">=</span> <span class="va">name</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/theme_pubr.html" class="external-link">theme_pubr</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 6 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>        <span class="va">rroc_perfs</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">fpr_global</span>, <span class="va">pval_asym_high</span>, <span class="va">w.pvalue</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">fpr_global</span>, names_to <span class="op">=</span> <span class="st">"name"</span>, values_to <span class="op">=</span> <span class="st">"p.value"</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fpr_global</span>, y <span class="op">=</span> <span class="op">(</span><span class="va">p.value</span><span class="op">)</span>, col <span class="op">=</span> <span class="va">name</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/theme_pubr.html" class="external-link">theme_pubr</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 6 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>        <span class="va">rroc_perfs</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">fpr_global</span>, <span class="va">pval_asym_high</span>, <span class="va">w.pvalue</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">fpr_global</span>, names_to <span class="op">=</span> <span class="st">"name"</span>, values_to <span class="op">=</span> <span class="st">"p.value"</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fpr_global</span>, y <span class="op">=</span> <span class="op">(</span><span class="va">p.value</span><span class="op">)</span>, col <span class="op">=</span> <span class="va">name</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rroc_perfs</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fpr_global"</span>, <span class="st">"rzAUC_high"</span><span class="op">)</span><span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">rzAUC_high</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"-abs(rzAUC_high)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/theme_pubr.html" class="external-link">theme_pubr</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 6 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span>
<span><span class="co">#&gt; Removed 3 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># print(</span></span>
<span><span class="co">#     ggplot(</span></span>
<span><span class="co">#         rroc_perfs |&gt;</span></span>
<span><span class="co">#             dplyr::select(fpr_global, pval_asym_high, w.pvalue) |&gt;</span></span>
<span><span class="co">#             tidyr::pivot_longer(-fpr_global, names_to = "name", values_to = "p.value"),</span></span>
<span><span class="co">#         aes(x = fpr_global, y = (p.value), col = name)</span></span>
<span><span class="co">#     ) +</span></span>
<span><span class="co">#         geom_line() +</span></span>
<span><span class="co">#         geom_line(data = rroc_perfs[, c("fpr_global", "rzAUC_high")], aes(y = -abs(rzAUC_high), col = "-abs(rzAUC_high)")) +</span></span>
<span><span class="co">#         ggpubr::theme_pubr()</span></span>
<span><span class="co"># )</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>        <span class="va">rroc_perfs</span>,</span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">rzAUC_high</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">pval_asym_high</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/theme_pubr.html" class="external-link">theme_pubr</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 3 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>        <span class="va">rroc_perfs</span>,</span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">rzAUC_high</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">w.pvalue</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/theme_pubr.html" class="external-link">theme_pubr</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 3 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>        <span class="va">rroc_perfs</span>,</span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fpr_global</span>, y <span class="op">=</span> <span class="va">w.pvalue</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/theme_pubr.html" class="external-link">theme_pubr</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 3 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>        <span class="va">rroc_perfs</span>,</span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fpr_global</span>, y <span class="op">=</span> <span class="va">pval_asym_high</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/theme_pubr.html" class="external-link">theme_pubr</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 3 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>        <span class="va">rroc_perfs</span>,</span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fpr_global</span>, y <span class="op">=</span> <span class="va">rzAUC_high</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/theme_pubr.html" class="external-link">theme_pubr</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 3 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>        <span class="va">rroc_perfs</span>,</span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pval_asym_high</span>, y <span class="op">=</span> <span class="va">w.pvalue</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/theme_pubr.html" class="external-link">theme_pubr</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 3 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">dup_labels</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">rroc_perfs</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"positives_high"</span>, <span class="st">"negatives_high"</span><span class="op">)</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">sum</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="va">tmp</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">x</span>, <span class="kw">function</span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">rroc_perfs</span><span class="op">[[</span><span class="st">"fpr_global"</span><span class="op">]</span><span class="op">]</span> <span class="op">-</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>        <span class="va">rroc_perfs</span>,</span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fpr_global</span>, y <span class="op">=</span> <span class="va">pval_asym_high</span> <span class="op">-</span> <span class="va">w.pvalue</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/theme_pubr.html" class="external-link">theme_pubr</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>sec.axis <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/sec_axis.html" class="external-link">dup_axis</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">dup_labels</span>, name <span class="op">=</span> <span class="st">"Total number of samples"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 3 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; agg_png </span></span>
<span><span class="co">#&gt;       2</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gunther Glehr.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
